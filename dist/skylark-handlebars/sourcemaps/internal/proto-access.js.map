{"version":3,"sources":["internal/proto-access.js"],"names":["define","a","logger","loggedProperties","Object","create","checkWhiteList","protoAccessControlForType","propertyName","undefined","whitelist","defaultValue","log","logUnexpecedPropertyAccessOnce","createProtoAccessControl","runtimeOptions","defaultMethodWhiteList","defaultPropertyWhiteList","properties","createNewLookupObject","allowedProtoProperties","allowProtoPropertiesByDefault","methods","allowedProtoMethods","allowProtoMethodsByDefault","resultIsAllowed","result","protoAccessControl","resetLoggedProperties","keys","forEach"],"mappings":";;;;;;;AAAAA,QACI,6BACA,aACD,SAAUC,EAAGC,GACZ,aACA,MAAMC,EAAmBC,OAAOC,OAAO,MA2BvC,SAASC,EAAeC,EAA2BC,GAC/C,YAA0DC,IAAtDF,EAA0BG,UAAUF,IACyB,IAAtDD,EAA0BG,UAAUF,QAEAC,IAA3CF,EAA0BI,aACnBJ,EAA0BI,cAKzC,SAAwCH,IACG,IAAnCL,EAAiBK,KACjBL,EAAiBK,IAAgB,EACjCN,EAAOU,IAAI,uEAAyEJ,0DAAwE,wLANhKK,CAA+BL,IACxB,GAaX,OACIM,yBAhDJ,SAAkCC,GAC9B,IAAIC,EAAyBZ,OAAOC,OAAO,MAC3CW,EAAoC,aAAI,EACxCA,EAAyC,kBAAI,EAC7CA,EAAyC,kBAAI,EAC7CA,EAAyC,kBAAI,EAC7C,IAAIC,EAA2Bb,OAAOC,OAAO,MAE7C,OADAY,EAAoC,WAAI,GAEpCC,YACIR,UAAWT,EAAEkB,sBAAsBF,EAA0BF,EAAeK,wBAC5ET,aAAcI,EAAeM,+BAEjCC,SACIZ,UAAWT,EAAEkB,sBAAsBH,EAAwBD,EAAeQ,qBAC1EZ,aAAcI,EAAeS,8BAkCrCC,gBA9BJ,SAAyBC,EAAQC,EAAoBnB,GACjD,OACWF,EADW,mBAAXoB,EACeC,EAAmBL,QAEnBK,EAAmBT,WAFSV,IA6BtDoB,sBARJ,WACIxB,OAAOyB,KAAK1B,GAAkB2B,QAAQtB,WAC3BL,EAAiBK","file":"../../internal/proto-access.js","sourcesContent":["define([\n    './create-new-lookup-object',\n    '../logger'\n], function (a, logger) {\n    'use strict';\n    const loggedProperties = Object.create(null);\n    function createProtoAccessControl(runtimeOptions) {\n        let defaultMethodWhiteList = Object.create(null);\n        defaultMethodWhiteList['constructor'] = false;\n        defaultMethodWhiteList['__defineGetter__'] = false;\n        defaultMethodWhiteList['__defineSetter__'] = false;\n        defaultMethodWhiteList['__lookupGetter__'] = false;\n        let defaultPropertyWhiteList = Object.create(null);\n        defaultPropertyWhiteList['__proto__'] = false;\n        return {\n            properties: {\n                whitelist: a.createNewLookupObject(defaultPropertyWhiteList, runtimeOptions.allowedProtoProperties),\n                defaultValue: runtimeOptions.allowProtoPropertiesByDefault\n            },\n            methods: {\n                whitelist: a.createNewLookupObject(defaultMethodWhiteList, runtimeOptions.allowedProtoMethods),\n                defaultValue: runtimeOptions.allowProtoMethodsByDefault\n            }\n        };\n    }\n    function resultIsAllowed(result, protoAccessControl, propertyName) {\n        if (typeof result === 'function') {\n            return checkWhiteList(protoAccessControl.methods, propertyName);\n        } else {\n            return checkWhiteList(protoAccessControl.properties, propertyName);\n        }\n    }\n    function checkWhiteList(protoAccessControlForType, propertyName) {\n        if (protoAccessControlForType.whitelist[propertyName] !== undefined) {\n            return protoAccessControlForType.whitelist[propertyName] === true;\n        }\n        if (protoAccessControlForType.defaultValue !== undefined) {\n            return protoAccessControlForType.defaultValue;\n        }\n        logUnexpecedPropertyAccessOnce(propertyName);\n        return false;\n    }\n    function logUnexpecedPropertyAccessOnce(propertyName) {\n        if (loggedProperties[propertyName] !== true) {\n            loggedProperties[propertyName] = true;\n            logger.log('error', `Handlebars: Access has been denied to resolve the property \"${ propertyName }\" because it is not an \"own property\" of its parent.\\n` + `You can add a runtime option to disable the check or this warning:\\n` + `See https://handlebarsjs.com/api-reference/runtime-options.html#options-to-control-prototype-access for details`);\n        }\n    }\n    function resetLoggedProperties() {\n        Object.keys(loggedProperties).forEach(propertyName => {\n            delete loggedProperties[propertyName];\n        });\n    }\n    return {\n        createProtoAccessControl: createProtoAccessControl,\n        resultIsAllowed: resultIsAllowed,\n        resetLoggedProperties: resetLoggedProperties\n    };\n});"]}