/**
 * skylark-handlebars - A version of handlebars.js that ported to running on skylarkjs
 * @author Hudaokeji, Inc.
 * @version v0.9.0
 * @link https://github.com/skylark-integration/skylark-handlebars/
 * @license MIT
 */
define(["./utils","./exception","./base","./helpers","./internal/wrapHelper","./internal/proto-access"],function(e,t,o,r,n,a){"use strict";function l(e,t,o,r,n,a,l){function i(t,n={}){let i=l;return!l||t==l[0]||t===e.nullContext&&null===l[0]||(i=[t].concat(l)),o(e,t,e.helpers,e.partials,n.data||r,a&&[n.blockParams].concat(a),i)}return(i=s(o,i,e,l,r,a)).program=t,i.depth=l?l.length:0,i.blockParams=n||0,i}function i(){return""}function s(t,o,r,n,a,l){if(t.decorator){let i={};o=t.decorator(o,i,r,n&&n[0],a,l,n),e.extend(o,i)}return o}return{checkRevision:function(e){const r=e&&e[0]||1,n=o.COMPILER_REVISION;if(!(r>=o.LAST_COMPATIBLE_COMPILER_REVISION&&r<=o.COMPILER_REVISION)){if(r<o.LAST_COMPATIBLE_COMPILER_REVISION){const e=o.REVISION_CHANGES[n],a=o.REVISION_CHANGES[r];throw new t("Template was precompiled with an older version of Handlebars than the current runtime. Please update your precompiler to a newer version ("+e+") or downgrade your runtime to an older version ("+a+").")}throw new t("Template was precompiled with a newer version of Handlebars than the current runtime. Please update your runtime to a newer version ("+e[1]+").")}},template:function(i,c){if(!c)throw new t("No environment passed to template");if(!i||!i.main)throw new t("Unknown template object: "+typeof i);i.main.decorator=i.main_d,c.VM.checkRevision(i.compiler);const p=i.compiler&&7===i.compiler[0];let u={strict:function(e,o,r){if(!(e&&o in e))throw new t('"'+o+'" not defined in '+e,{loc:r});return e[o]},lookupProperty:function(e,t){let o=e[t];return null==o?o:Object.prototype.hasOwnProperty.call(e,t)?o:a.resultIsAllowed(o,u.protoAccessControl,t)?o:void 0},lookup:function(e,t){const o=e.length;for(let r=0;r<o;r++)if(null!=(e[r]&&u.lookupProperty(e[r],t)))return e[r][t]},lambda:function(e,t){return"function"==typeof e?e.call(t):e},escapeExpression:e.escapeExpression,invokePartial:function(o,r,n){n.hash&&(r=e.extend({},r,n.hash),n.ids&&(n.ids[0]=!0)),o=c.VM.resolvePartial.call(this,o,r,n);let a=e.extend({},n,{hooks:this.hooks,protoAccessControl:this.protoAccessControl}),l=c.VM.invokePartial.call(this,o,r,a);if(null==l&&c.compile&&(n.partials[n.name]=c.compile(o,i.compilerOptions,c),l=n.partials[n.name](r,a)),null!=l){if(n.indent){let e=l.split("\n");for(let t=0,o=e.length;t<o&&(e[t]||t+1!==o);t++)e[t]=n.indent+e[t];l=e.join("\n")}return l}throw new t("The partial "+n.name+" could not be compiled when running in runtime-only mode")},fn:function(e){let t=i[e];return t.decorator=i[e+"_d"],t},programs:[],program:function(e,t,o,r,n){let a=this.programs[e],i=this.fn(e);return t||n||r||o?a=l(this,e,i,t,o,r,n):a||(a=this.programs[e]=l(this,e,i)),a},data:function(e,t){for(;e&&t--;)e=e._parent;return e},mergeIfNeeded:function(t,o){let r=t||o;return t&&o&&t!==o&&(r=e.extend({},o,t)),r},nullContext:Object.seal({}),noop:c.VM.noop,compilerInfo:i.compiler};function d(e,t={}){let r=t.data;d._setup(t),!t.partial&&i.useData&&(r=function(e,t){return t&&"root"in t||((t=t?o.createFrame(t):{}).root=e),t}(e,r));let n,a=i.useBlockParams?[]:void 0;function l(e){return""+i.main(u,e,u.helpers,u.partials,r,a,n)}return i.useDepths&&(n=t.depths?e!=t.depths[0]?[e].concat(t.depths):t.depths:[e]),(l=s(i.main,l,u,t.depths||[],r,a))(e,t)}return d.isTop=!0,d._setup=function(t){if(t.partial)u.protoAccessControl=t.protoAccessControl,u.helpers=t.helpers,u.partials=t.partials,u.decorators=t.decorators,u.hooks=t.hooks;else{let o=e.extend({},c.helpers,t.helpers);!function(t,o){Object.keys(t).forEach(r=>{let a=t[r];t[r]=function(t,o){const r=o.lookupProperty;return n.wrapHelper(t,t=>e.extend({lookupProperty:r},t))}(a,o)})}(o,u),u.helpers=o,i.usePartial&&(u.partials=u.mergeIfNeeded(t.partials,c.partials)),(i.usePartial||i.useDecorators)&&(u.decorators=e.extend({},c.decorators,t.decorators)),u.hooks={},u.protoAccessControl=a.createProtoAccessControl(t);let l=t.allowCallsToHelperMissing||p;r.moveHelperToHooks(u,"helperMissing",l),r.moveHelperToHooks(u,"blockHelperMissing",l)}},d._child=function(e,o,r,n){if(i.useBlockParams&&!r)throw new t("must pass block params");if(i.useDepths&&!n)throw new t("must pass parent depths");return l(u,e,i[e],o,0,r,n)},d},wrapProgram:l,resolvePartial:function(e,t,o){return e?e.call||o.name||(o.name=e,e=o.partials[e]):e="@partial-block"===o.name?o.data["partial-block"]:o.partials[o.name],e},invokePartial:function(r,n,a){const l=a.data&&a.data["partial-block"];let s;if(a.partial=!0,a.ids&&(a.data.contextPath=a.ids[0]||a.data.contextPath),a.fn&&a.fn!==i){a.data=o.createFrame(a.data);let t=a.fn;s=a.data["partial-block"]=function(e,r={}){return r.data=o.createFrame(r.data),r.data["partial-block"]=l,t(e,r)},t.partials&&(a.partials=e.extend({},a.partials,t.partials))}if(void 0===r&&s&&(r=s),void 0===r)throw new t("The partial "+a.name+" could not be found");if(r instanceof Function)return r(n,a)},noop:i}});
//# sourceMappingURL=sourcemaps/runtime.js.map
